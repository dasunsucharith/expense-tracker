<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Incomes - Expense Tracker</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        <link rel="stylesheet" href="/styles.css">
    </head>
    <body>
        <!-- Navigation -->
        {% include 'navbar.html' %}

        <!-- Main Content -->
        <div class="container-fluid mt-4" id="incomes-page">
            <!-- Hero Section -->
            <div class="page-hero slide-in-up">
                <div class="row align-items-center">
                    <div class="col-lg-8">
                        <h2><i class="fas fa-money-bill-wave me-3"></i>Income Management</h2>
                        <p class="mb-3 fs-5">Track and optimize your revenue streams</p>
                        <div class="hero-stats">
                            <div class="hero-stat">
                                <span class="hero-stat-value" id="hero-total">
                                    <span class="currency-symbol">$</span>0.00
                                </span>
                                <span class="hero-stat-label">Total Income</span>
                            </div>
                            <div class="hero-stat">
                                <span class="hero-stat-value" id="hero-count">0</span>
                                <span class="hero-stat-label">Transactions</span>
                            </div>
                            <div class="hero-stat">
                                <span class="hero-stat-value" id="hero-average">
                                    <span class="currency-symbol">$</span>0.00
                                </span>
                                <span class="hero-stat-label">Average</span>
                            </div>
                            <div class="hero-stat">
                                <span class="hero-stat-value" id="hero-last-date">-</span>
                                <span class="hero-stat-label">Last Entry</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 text-end">
                        <button class="btn btn-light btn-lg quick-add-btn" data-bs-toggle="modal" data-bs-target="#addIncomeModal">
                            <i class="fas fa-plus me-2"></i>Add Income
                        </button>
                    </div>
                </div>
            </div>

            <!-- Search and Filters -->
            <div class="filters-panel slide-in-up">
                <!-- Search Box -->
                <div class="search-box">
                    <input type="text" class="search-input" id="income-search" placeholder="Search incomes by description, type, or amount...">
                    <i class="fas fa-search search-icon"></i>
                </div>

                <div class="row">
                    <div class="col-lg-4 col-md-6">
                        <div class="filter-group">
                            <label class="filter-label">
                                <i class="fas fa-calendar-alt text-primary"></i>
                                Date Range
                            </label>
                            <select class="form-select filter-input" id="income-date-filter">
                                <option value="this-month">üìÖ This Month</option>
                                <option value="last-month">üìÜ Last Month</option>
                                <option value="last-3-months">üìä Last 3 Months</option>
                                <option value="this-year">üóìÔ∏è This Year</option>
                                <option value="custom">‚öôÔ∏è Custom Range</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="filter-group">
                            <label class="filter-label">
                                <i class="fas fa-tags text-success"></i>
                                Income Type
                            </label>
                            <select class="form-select filter-input" id="income-type-filter">
                                <option value="">üè∑Ô∏è All Types</option>
                                <option value="Salary">üíº Salary</option>
                                <option value="Business">üè¢ Business</option>
                                <option value="Investments">üìà Investments</option>
                                <option value="Other">üîß Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12">
                        <div class="filter-group">
                            <label class="filter-label">&nbsp;</label>
                            <button class="btn btn-gradient w-100 filter-input" id="apply-income-filters">
                                <i class="fas fa-filter me-2"></i>Apply Filters
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Custom Date Range -->
                <div class="row d-none" id="income-custom-date-range">
                    <div class="col-md-6">
                        <div class="filter-group">
                            <label class="filter-label">
                                <i class="fas fa-play text-success"></i>
                                Start Date
                            </label>
                            <input type="date" class="form-control filter-input" id="income-start-date">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="filter-group">
                            <label class="filter-label">
                                <i class="fas fa-stop text-danger"></i>
                                End Date
                            </label>
                            <input type="date" class="form-control filter-input" id="income-end-date">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Incomes Table -->
            <div class="incomes-table-container slide-in-up">
                <div class="table-header">
                    <div class="d-flex justify-content-between align-items-center flex-wrap">
                        <h5 class="table-title">
                            <i class="fas fa-list"></i>
                            Income Records
                            <span class="badge bg-light text-dark ms-2" id="record-count">0 records</span>
                        </h5>
                        <div class="table-actions">
                            <button class="btn export-btn" onclick="exportIncomes('csv')" title="Export as CSV">
                                <i class="fas fa-file-csv me-1"></i>CSV
                            </button>
                            <button class="btn export-btn" onclick="exportIncomes('excel')" title="Export as Excel">
                                <i class="fas fa-file-excel me-1"></i>Excel
                            </button>
                            <button class="btn export-btn" onclick="exportIncomes('pdf')" title="Export as PDF">
                                <i class="fas fa-file-pdf me-1"></i>PDF
                            </button>
                            <button class="btn export-btn" onclick="printIncomes()" title="Print">
                                <i class="fas fa-print me-1"></i>Print
                            </button>
                        </div>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table advanced-table mb-0">
                        <thead>
                            <tr>
                                <th style="cursor: pointer" onclick="sortTable('date')">
                                    <i class="fas fa-calendar me-1"></i>Date
                                    <i class="fas fa-sort sort-icon" id="sort-date"></i>
                                </th>
                                <th style="cursor: pointer" onclick="sortTable('type')">
                                    <i class="fas fa-tag me-1"></i>Type
                                    <i class="fas fa-sort sort-icon" id="sort-type"></i>
                                </th>
                                <th><i class="fas fa-comment me-1"></i>Description</th>
                                <th style="cursor: pointer" onclick="sortTable('amount')">
                                    <i class="fas fa-dollar-sign me-1"></i>Amount
                                    <i class="fas fa-sort sort-icon" id="sort-amount"></i>
                                </th>
                                <th><i class="fas fa-cog me-1"></i>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="incomes-table">
                            <!-- Incomes will be loaded here -->
                        </tbody>
                    </table>

                    <!-- Empty State -->
                    <div id="empty-state" class="empty-state d-none">
                        <i class="fas fa-money-bill-wave empty-state-icon"></i>
                        <h4>No Income Records Found</h4>
                        <p>You haven't recorded any income yet.<br>Click "Add Income" to start tracking your earnings!</p>
                        <button class="btn quick-add-btn" data-bs-toggle="modal" data-bs-target="#addIncomeModal">
                            <i class="fas fa-plus me-2"></i>Add Your First Income
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Add Button -->
        <button class="floating-add-btn" data-bs-toggle="modal" data-bs-target="#addIncomeModal" title="Add Income">
            <i class="fas fa-plus"></i>
        </button>

        <!-- Modals -->
        <!-- Add Income Modal -->
        <div class="modal fade" id="addIncomeModal" tabindex="-1" aria-labelledby="addIncomeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header bg-success text-white">
                        <h5 class="modal-title" id="addIncomeModalLabel">
                            <i class="fas fa-plus-circle me-2"></i>Add New Income
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="add-income-form">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-floating">
                                        <div class="input-group">
                                            <span class="input-group-text currency-symbol">$</span>
                                            <input type="number" class="form-control" id="income-amount" step="0.01" min="0.01" placeholder="0.00" required>
                                            <label for="income-amount">
                                                <i class="fas fa-dollar-sign me-1 text-success"></i>Amount *
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-text">Enter the income amount</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-floating">
                                        <select class="form-select" id="income-type" required>
                                            <option value="">Select income type</option>
                                            <option value="Salary">üíº Salary</option>
                                            <option value="Business">üè¢ Business</option>
                                            <option value="Investments">üìà Investments</option>
                                            <option value="Other">üîß Other</option>
                                        </select>
                                        <label for="income-type">
                                            <i class="fas fa-tags me-1 text-info"></i>Income Type *
                                        </label>
                                    </div>
                                    <div class="form-text">Choose income source</div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3 d-none" id="other-source-group">
                                    <div class="form-floating">
                                        <input type="text" class="form-control" id="other-source" placeholder="Enter other source">
                                        <label for="other-source">
                                            <i class="fas fa-edit me-1 text-secondary"></i>Other Source
                                        </label>
                                    </div>
                                    <div class="form-text">Specify the income source</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-floating">
                                        <input type="date" class="form-control" id="income-date" required>
                                        <label for="income-date">
                                            <i class="fas fa-calendar me-1 text-warning"></i>Date *
                                        </label>
                                    </div>
                                    <div class="form-text">When did you receive this income?</div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="income-description" placeholder="Enter income description (optional)">
                                    <label for="income-description">
                                        <i class="fas fa-comment me-1 text-secondary"></i>Description
                                    </label>
                                </div>
                                <div class="form-text">Add any additional details about this income</div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="fas fa-times me-1"></i>Cancel
                        </button>
                        <button type="button" class="btn btn-success" id="save-income">
                            <i class="fas fa-save me-1"></i>Save Income
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Income Modal -->
        <div class="modal fade" id="editIncomeModal" tabindex="-1" aria-labelledby="editIncomeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header bg-warning text-dark">
                        <h5 class="modal-title" id="editIncomeModalLabel">
                            <i class="fas fa-edit me-2"></i>Edit Income
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="edit-income-form">
                            <input type="hidden" id="edit-income-id">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-floating">
                                        <div class="input-group">
                                            <span class="input-group-text currency-symbol">$</span>
                                            <input type="number" class="form-control" id="edit-income-amount" step="0.01" min="0.01" required>
                                            <label for="edit-income-amount">
                                                <i class="fas fa-dollar-sign me-1 text-success"></i>Amount *
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-floating">
                                        <select class="form-select" id="edit-income-type" required>
                                            <option value="Salary">üíº Salary</option>
                                            <option value="Business">üè¢ Business</option>
                                            <option value="Investments">üìà Investments</option>
                                            <option value="Other">üîß Other</option>
                                        </select>
                                        <label for="edit-income-type">
                                            <i class="fas fa-tags me-1 text-info"></i>Income Type *
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3 d-none" id="edit-other-source-group">
                                    <div class="form-floating">
                                        <input type="text" class="form-control" id="edit-other-source">
                                        <label for="edit-other-source">
                                            <i class="fas fa-edit me-1 text-secondary"></i>Other Source
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-floating">
                                        <input type="date" class="form-control" id="edit-income-date" required>
                                        <label for="edit-income-date">
                                            <i class="fas fa-calendar me-1 text-warning"></i>Date *
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="edit-income-description">
                                    <label for="edit-income-description">
                                        <i class="fas fa-comment me-1 text-secondary"></i>Description
                                    </label>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="fas fa-times me-1"></i>Cancel
                        </button>
                        <button type="button" class="btn btn-danger me-auto" id="delete-income">
                            <i class="fas fa-trash me-1"></i>Delete
                        </button>
                        <button type="button" class="btn btn-primary" id="update-income">
                            <i class="fas fa-save me-1"></i>Update Income
                        </button>
                    </div>
                </div>
            </div>
        </div>

    <!-- Loading Spinner Overlay -->
        <div id="loading-overlay" class="d-none"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;">
            <div class="spinner-border text-light" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>

        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
        <script src="/app.js"></script>

    </body>
</html>